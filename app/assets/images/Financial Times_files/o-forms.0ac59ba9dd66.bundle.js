(window.webpackJsonp=window.webpackJsonp||[]).push([["o-forms"],{ddbd4943:function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}n.r(e);var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.input=e,this.parent=e.closest(".o-forms-input"),this.input.addEventListener("blur",this),this.input.addEventListener("input",this),this.className={invalid:"o-forms-input--invalid",valid:"o-forms-input--valid"}}var e,n,s;return e=t,(n=[{key:"handleEvent",value:function(t){"blur"!==t.type&&"input"!==t.type||this.validate(t.target)}},{key:"validate",value:function(){if(this.parent)return this.input.validity.valid?(this.input.validity.valid&&this.parent.classList.contains(this.className.invalid)&&(this.parent.classList.remove(this.className.invalid),this.parent.classList.add(this.className.valid)),!0):(this.parent.classList.add(this.className.invalid),!1)}},{key:"destroy",value:function(){this.input.removeEventListener("blur",this),this.input.removeEventListener("input",this),this.input=null}}])&&i(e.prototype,n),s&&i(e,s),t}();function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var a=function(){function t(e,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!(e instanceof RadioNodeList))throw new Error("State can only be applied to `radio` type inputs.");this.inputs=e,this.parent=this.inputs[0].closest(".o-forms-input"),this._verify(),this.opts=Object.assign({iconOnly:!1},n),this.className={saving:"o-forms-input--saving",saved:"o-forms-input--saved"}}var e,n,i;return e=t,(n=[{key:"_generateStateEl",value:function(){var t;this.stateEl=document.createElement("span");var e=this.opts.iconOnly?["o-forms-input__state","o-forms-input__state--icon-only"]:["o-forms-input__state"];(t=this.stateEl.classList).add.apply(t,e),this.parent.append(this.stateEl)}},{key:"set",value:function(t,e){if(this.stateEl||this._generateStateEl(),"saving"===t)this._saving(e);else if("saved"===t)this._saved(e);else{if("none"!==t)throw new Error("".concat(t," is not a recognised state, the options are 'saving', 'saved' or 'none'."));this._remove()}}},{key:"_saving",value:function(t){this.parent.classList.remove(this.className.saved),this.parent.classList.add(this.className.saving),this.stateEl.classList.toggle("o-forms-input__state--custom",Boolean(t)),this.stateEl.textContent=t&&!this.opts.iconOnly?t:"",this.stateEl.setAttribute("aria-label",t||"Saving")}},{key:"_saved",value:function(t){this.parent.classList.remove(this.className.saving),this.parent.classList.add(this.className.saved),this.stateEl.classList.toggle("o-forms-input__state--custom",Boolean(t)),this.stateEl.textContent=t&&!this.opts.iconOnly?t:"",this.stateEl.setAttribute("aria-label",t||"Saved")}},{key:"_remove",value:function(){this.parent.classList.remove(this.className.saving),this.parent.classList.remove(this.className.saved),this.parent.removeChild(this.stateEl),this.stateEl=null}},{key:"_verify",value:function(){if(!this.parent.classList.contains("o-forms-input--radio-box"))throw new Error("State can only be set on radio inputs with a box style (o-forms-input--radio-box).");if(this.parent.classList.contains(".o-forms--input-invalid"))throw new Error("State cannot be set on an invalid input field.")}}])&&r(e.prototype,n),i&&r(e,i),t}();function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var l=function(){function t(e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.elements=e,this.invalidInputs=[],this.createSummary()}var e,n,i;return e=t,i=[{key:"createList",value:function(e){var n=document.createElement("ul");n.classList.add("o-forms__error-summary__list");var i=[];return e.forEach((function(e){if(!i.includes(e.field)&&(e.field&&i.push(e.field),!1!==e.valid||e.label||console.warn('Could not add an invalid input to the error summary. Check the input has a parent `o-forms-field` element with correct title markup. Or disable the error summary feature for this form with `data-o-forms-error-summary="false"`.',e.element),!1===e.valid&&e.label)){var s=t.createItem(e);n.appendChild(s)}})),n}},{key:"createItem",value:function(e){var n=document.createElement("li");if(n.classList.add("o-forms__error-summary__item"),e.id){var i=t.createAnchor(e);return n.appendChild(i),n}return console.warn("Could not link to an invalid input from the error summary. Add a unique id attribute to the input element.",e.element),n.innerHTML=t._getItemContent(e),n}},{key:"createAnchor",value:function(e){var n=document.createElement("a");return n.setAttribute("href","#".concat(e.id)),n.addEventListener("click",function(t){t.preventDefault(),document.getElementById(this.id).focus()}.bind(e)),n.innerHTML=t._getItemContent(e),n}},{key:"_getItemContent",value:function(t){return'<span class="o-forms__error-summary__item-overview">'+"".concat(t.label,"</span>: ")+'<span class="o-forms__error-summary__item-detail">'.concat(t.error,"</span>")}}],(n=[{key:"createSummary",value:function(){var e=this.elements.filter((function(t){return!t.valid})),n=document.createElement("div");return n.classList.add("o-forms__error-summary"),n.setAttribute("aria-labelledby","error-summary"),n.setAttribute("role","alert"),n.innerHTML='<h4 class="o-forms__error-summary__heading" id="error-summary">There is a problem</h4>',n.appendChild(t.createList(e)),n}}])&&o(e.prototype,n),i&&o(e,i),t}();function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var c=function(){function t(e,n){var i=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"FORM"!==e.nodeName)throw new Error('[data-o-component="o-forms"] must be set on a form element. It is currently set on a \''.concat(e.nodeName.toLowerCase(),"'."));this.form=e,this.formInputs=Array.from(this.form.elements,(function(t){return new s(t)})),this.stateElements=[],this.opts=Object.assign({useBrowserValidation:!1,errorSummary:!0},n||t.getDataAttributes(e)),this.opts.useBrowserValidation?(this.form.removeAttribute("novalidate"),this.submits=this.form.querySelectorAll("[type=submit]"),this.submits.forEach((function(t){t.addEventListener("click",i),t.addEventListener("keydown",i)}))):(this.form.setAttribute("novalidate",!0),this.form.addEventListener("submit",this))}var e,n,i;return e=t,i=[{key:"getDataAttributes",value:function(t){return t instanceof HTMLElement?Object.keys(t.dataset).reduce((function(e,n){if("oComponent"===n)return e;var i=n.replace(/^oMessage(\w)(\w+)$/,(function(t,e,n){return e.toLowerCase()+n})),s=t.dataset[n];try{e[i]=JSON.parse(s.replace(/\'/g,'"'))}catch(t){e[i]=s}return e}),{}):{}}},{key:"init",value:function(e,n){return e||(e=document.body),e instanceof HTMLElement||(e=document.querySelector(e)),e instanceof HTMLFormElement?new t(e,n):Array.from(e.querySelectorAll('[data-o-component="o-forms"]'),(function(e){return new t(e,n)}))}}],(n=[{key:"handleEvent",value:function(t){if(("click"===t.type||"keydown"===t.type&&13===t.key)&&!1===this.form.checkValidity()&&this.validateFormInputs(),"submit"===t.type){t.preventDefault();var e=this.validateFormInputs();if(e.some((function(t){return!1===t.valid}))){if(this.opts.errorSummary){if(this.summary){var n=new l(e);this.form.replaceChild(n,this.summary),this.summary=n}else this.summary=this.form.insertBefore(new l(e),this.form.firstElementChild);var i=this.summary.querySelector("a");i&&i.focus()}return}t.target.submit()}}},{key:"validateFormInputs",value:function(){return this.formInputs.map((function(t){var e=t.validate(),n=t.input,i=n.closest(".o-forms-field"),s=i?i.querySelector(".o-forms-title__main"):null,r=s?s.textContent:null,a=i?i.querySelector(".o-forms-input__error"):null,o=a?a.textContent:n.validationMessage;return{id:n.id,valid:e,error:e?null:o,label:r,field:i,element:t.input}}))}},{key:"setState",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{iconLabel:null,iconOnly:!1};if("object"!=typeof n||null===n||Array.isArray(n))throw new Error("The `options` argument must be an object");var i=this.stateElements.find((function(t){return t.name===e}));i||(i={name:e,element:new a(this.form.elements[e],n)},this.stateElements.push(i)),i.element.set(t,n.iconLabel)}},{key:"destroy",value:function(){var t=this;this.opts.useBrowserValidation?this.submits.forEach((function(e){e.removeEventListener("click",t),e.removeEventListener("keydown",t)})):this.form.removeEventListener("submit",this),this.form=null,this.formInputs.forEach((function(t){return t.destroy()})),this.formInputs=null,this.stateElements=null,this.opts=null}}])&&u(e.prototype,n),i&&u(e,i),t}();document.addEventListener("o.DOMContentLoaded",(function t(){c.init(),document.removeEventListener("o.DOMContentLoaded",t)}));e.default=c}}]);
//# sourceMappingURL=o-forms.0ac59ba9dd66.bundle.js.map