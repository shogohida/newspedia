(window.webpackJsonp=window.webpackJsonp||[]).push([["financial-times-o-tracking"],{"00714c93":function(e,t,n){"use strict";function r(){var e=new window.XMLHttpRequest;return{name:"xhr",send:function(t,n){e.open("POST",t,!0),e.withCredentials=!0,e.setRequestHeader("Content-type","application/json"),e.send(n)},complete:function(t){e.onerror=function(){t(this)},e.onload=function(){e.status>=200&&e.status<300?t():t("Incorrect response: "+e.status)}}}}Object.defineProperty(t,"__esModule",{value:!0}),t.xhr=r,t.default=void 0;var o=r;t.default=o},"0887d82c":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateConfig=t.event=t.page=t.init=t.link=t.tracking=t.default=void 0;var r=g(n("4f317c41")),o=g(n("1cfe9588")),a=g(n("6be2d8c7")),i=g(n("f1b1acb7")),u=g(n("517634a8")),c=g(n("0cbc56d8")),d=g(n("b4bf6f47")),s=g(n("a09a7426")),f=g(n("9caaec1a")),l=g(n("3e12a51d"));function g(e){return e&&e.__esModule?e:{default:e}}function v(){this.version="2.0.0",this.source="o-tracking",this.api_key="qUb9maKfKbtpRsdp0p2J7uWxRPGJEP",this.initialised=!1}v.prototype.developer=function(e){e?r.default.set("developer",!0):(r.default.destroy("developer",null),r.default.destroy("no_send",null))},v.prototype.destroy=function(){this.developer(!1),this.initialised=!1,r.default.destroy("config"),r.default.destroy("page_sent")},v.prototype.toString=function(){return"oTracking version 2.0.0"},v.prototype.event=u.default,v.prototype.page=c.default,v.prototype.view=l.default,v.prototype.click=d.default,v.prototype.link={init:function(e){return v.prototype.click.init("link")}},v.prototype.utils=s.default,v.prototype.getRootID=f.default.getRootID,v.prototype.init=function(e){if(this.initialised)return this;if(e=e||{},Boolean(this._getDeclarativeConfigElement())&&(e=this._getDeclarativeConfig(e)),0===Object.keys(e).length&&e.constructor===Object)return null;r.default.set("version",this.version),r.default.set("source",this.source),r.default.set("api_key",this.api_key),r.default.set("page_sent",!1);var t=!!e&&e.cookieDomain;return o.default.init(!1,t),this.updateConfig(e),a.default.init(e.session),i.default.init(),this.event.init(),this.page.init(),this.initialised=!0,this},v.prototype.updateConfig=function(e){var t=r.default.get("config")||{};t=this.utils.merge(t,e),r.default.set("config",t),t.developer&&(this.developer(t.developer),t.noSend&&r.default.set("no_send",!0)),t.user&&t.user.user_id&&o.default.setUser(t.user.user_id),i.default.setDomain()},v.prototype._getDeclarativeConfigElement=function(){return document.querySelector("script[data-o-tracking-config]")},v.prototype._getDeclarativeConfig=function(e){var t,n,r=this._getDeclarativeConfigElement();if(!r)return!1;t=r.textContent||r.innerText||r.innerHTML;try{n=JSON.parse(t)}catch(e){var o=new Error('Invalid JSON configuration syntax, check validity for o-tracking configuration: "'+e.message+'"');throw this.utils.broadcast("oErrors","log",{error:o.message,info:{module:"o-tracking"}}),o}for(var a in n)n.hasOwnProperty(a)&&(e[a]=e[a]||n[a]);return e};var p=new v;t.tracking=p;var m=p.link;t.link=m;var h=p.init.bind(p);t.init=h;var y=p.page.bind(p);t.page=y;var b=p.event.bind(p);t.event=b;var w=p.updateConfig.bind(p);t.updateConfig=w,document.addEventListener("o.DOMContentLoaded",(function e(){p.init(),document.removeEventListener("o.DOMContentLoaded",e)}));var _=p;t.default=_},"0cbc56d8":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.page=u,t.default=void 0;var r=i(n("9caaec1a")),o=i(n("a09a7426")),a=i(n("4f317c41"));function i(e){return e&&e.__esModule?e:{default:e}}a.default.set("page_viewed",!1);function u(e,t){e=o.default.merge({category:"page",action:"view",context:{url:document.URL,referrer:document.referrer},async:!0},{context:e}),a.default.get("page_viewed")&&r.default.setRootID(),r.default.track(e,t),a.default.set("page_viewed",!0),o.default.triggerPage()}function c(e){u(e.detail)}u.init=function(){o.default.addEvent(window,"oTracking.page",c)};var d=u;t.default=d},"10e45b30":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Store=t.default=void 0;var r,o=(r=n("a09a7426"))&&r.__esModule?r:{default:r};var a=function(e,t){var n,r="o-tracking";if(o.default.isUndefined(e)){var a=new Error("You must specify a name for the store.");throw o.default.broadcast("oErrors","log",{error:a.message,info:{module:"o-tracking"}}),a}if(this.config=o.default.merge({storage:"best",expires:31536e7},t),this.data=null,this.storageKey=this.config.hasOwnProperty("nameOverride")?this.config.nameOverride:[r,e].join("_"),this.storage=function(e,t){var n=r+"_InternalTest";if("cookie"!==e.storage)try{if(t.localStorage&&(t.localStorage.setItem(n,"TEST"),"TEST"===t.localStorage.getItem(n)))return t.localStorage.removeItem(n),{_type:"localStorage",load:function(e){return t.localStorage.getItem(e)},save:function(e,n){return t.localStorage.setItem(e,n)},remove:function(e){return t.localStorage.removeItem(e)}}}catch(e){o.default.broadcast("oErrors","log",{error:e.message,info:{module:"o-tracking"}})}function a(e){e+="=";var n,r,a=t.document.cookie.split(";");for(n=0;n<a.length;n+=1)if(0===(r=a[n].replace(/^\s+|\s+$/g,"")).indexOf(e))return o.default.decode(r.substring(e.length,r.length));return null}function i(n,r,a){var i,u,c="";o.default.is(a,"number")&&((i=new Date).setTime(i.getTime()+a),c="expires="+i.toGMTString()+";"),u=o.default.encode(n)+"="+o.default.encode(r)+";"+c+"path=/;"+(e.domain?"domain=."+e.domain+";":""),t.document.cookie=u}function u(e){i(e,"",-1)}return i(n,"TEST"),"TEST"===a(n)?(u(n),{_type:"cookie",load:a,save:i,remove:u}):{_type:"none",load:function(){},save:function(){},remove:function(){}}}(this.config,window),n=this.storage.load(this.storageKey))try{this.data=JSON.parse(n)}catch(e){o.default.broadcast("oErrors","log",{error:e.message,module:"o-tracking"}),this.data=n}return this};t.Store=a,a.prototype.read=function(){return this.data},a.prototype.write=function(e){return this.data=e,this.storage.save(this.storageKey,"string"==typeof this.data?this.data:JSON.stringify(this.data),this.config.expires),this},a.prototype.destroy=function(){return this.data=null,this.storage.remove(this.storageKey),this};var i=a;t.default=i},"1cc17586":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Queue=t.default=void 0;var r=a(n("a09a7426")),o=a(n("10e45b30"));function a(e){return e&&e.__esModule?e:{default:e}}var i=function(e){if(r.default.isUndefined(e)){var t=new Error("You must specify a name for the queue.");throw r.default.broadcast("oErrors","log",{error:t.message,info:{module:"o-tracking"}}),t}return this.queue=[],this.storage=new o.default(e),this.storage.read()&&(this.queue=this.storage.read()),this};t.Queue=i,i.prototype.all=function(){if(0===this.queue.length)return[];for(var e=[],t=0;t<this.queue.length;t+=1)e.push(this.queue[t].item);return e},i.prototype.first=function(){return 0===this.queue.length?null:this.queue[0].item},i.prototype.last=function(){return 0===this.queue.length?null:this.queue.slice(-1)[0].item},i.prototype.add=function(e){var t,n=this;function o(e){n.queue.push({created_at:(new Date).valueOf(),item:e})}if(r.default.is(e,"object")&&e.constructor.toString().match(/array/i))for(t=0;t<e.length;t+=1)o(e[t]);else o(e);return n},i.prototype.replace=function(e){if(r.default.is(e,"object")&&e.constructor.toString().match(/array/i))return this.queue=[],this.add(e).save(),this;var t=new Error("Argument invalid, must be an array.");throw r.default.broadcast("oErrors","log",{error:t.message,info:{module:"o-tracking"}}),t},i.prototype.shift=function(){if(0===this.queue.length)return null;var e=this.queue.shift().item;return this.save(),e},i.prototype.save=function(){return this.storage.write(this.queue),this};var u=i;t.default=u},"1cfe9588":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=c,t.setUser=d,t.userID=f,t.destroy=s,t.default=void 0;var r,o,a=u(n("a09a7426")),i=u(n("10e45b30"));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){var n={storage:"cookie",name:"spoor-id",nameOverride:"spoor-id",value:null,domain:location.hostname.match(/^(?:.+\.)?ft\.com$/)?"ft.com":null};t&&(n.domain=t);var r=(o=new i.default(n.name,n)).read();return r||(r=e),d(r)}function d(e){return(r=e)||(r=a.default.guid()),o.write(r),r}function s(){o.destroy()}function f(){return r}var l={init:c,setUser:d,userID:f,destroy:s};t.default=l},"3e12a51d":function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.default=void 0;var a=c(n("9caaec1a")),i=c(n("e3731389")),u=c(n("a09a7426"));function c(e){return e&&e.__esModule?e:{default:e}}var d=["componentContentId","type","subtype","component"],s=function(e,t,n){var r,o=(0,i.default)(t),a=o.trace,c=o.customContext;if(n.getContextData){if("function"!=typeof n.getContextData)throw new Error("opts.getContextData is not a function");var s=n.getContextData(t);if("object"!=typeof s)throw new Error("opts.getContextData function should return {Object}");r=u.default.whitelistProps(s,d)}else r={};r.domPathTokens=a,r.url=window.document.location.href||null,u.default.assignIfUndefined(c,r),e.context=r},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(window.IntersectionObserver){var t=e.selector||"[data-o-tracking-view]",n=r(document.querySelectorAll(t));if(n.length){var o=new IntersectionObserver(i,{threshold:[1]});n.forEach((function(e){return o.observe(e)}))}}else console.warn('o-tracking: Unable to track component view events as "window.IntersectionObserver" is not supported.');function i(t){t.forEach((function(t){if(t.isIntersecting||t.intersectionRatio>0){var n={action:e.action||"view",category:e.category||"component"},r=t.target;s(n,r,e),a.default.track(n),o.unobserve(r)}}))}};t.init=f;var l={init:f};t.default=l},"4f317c41":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.destroy=a,t.get=t.set=t.default=void 0;var r={};function o(e){if(void 0===e)return e;switch(Object.prototype.toString.call(e)){case"[object Object]":return JSON.parse(JSON.stringify(e));case"[object Array]":return[].slice.call(e);default:return e}}function a(e){delete r[e]}var i=function(e,t){r[e]=o(t)};t.set=i;var u=function(e){return o(r[e])};t.get=u;var c={set:i,get:u,destroy:a};t.default=c},"517634a8":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.event=i,t.default=void 0;var r=a(n("9caaec1a")),o=a(n("a09a7426"));function a(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(o.default.is(e.detail.category)||o.default.is(e.detail.action)){throw o.default.broadcast("oErrors","log",{error:"Missing category or action values",info:{module:"o-tracking"}}),"Missing category or action values"}var n=o.default.merge({category:"event",action:"generic",context:{}},{category:e.detail.category,action:e.detail.action,context:e.detail});delete n.context.category,delete n.context.action;var a=function(e){var t=e.target||e.srcElement;if(t&&t.getAttribute("data-o-component"))return t}(e);a&&(n.context.component_name=a.getAttribute("data-o-component"),n.context.component_id=n.context.component_id||function(e){var t=function(e){var t=[];for(;e;)t.push(e),e=e.parentElement;return t}(e);if(void 0===t)return;var n=t[0],r=function(e){var t=e.parentElement;if(t){for(var r=0;r<t.childNodes.length;r++)if(t.childNodes[r]===n)return r;return-1}return 0}(n);return function(e){var t,n=e.length,r=1^n,o=0;for(;n>=4;)t=1540483477*(65535&(t=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24))+((1540483477*(t>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(t=1540483477*(65535&(t^=t>>>24))+((1540483477*(t>>>16)&65535)<<16)),n-=4,++o;switch(n){case 3:r^=(255&e.charCodeAt(o+2))<<16;break;case 2:r^=(255&e.charCodeAt(o+1))<<8;break;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(o)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0}(t.reduceRight((function(e,t){if(!t.nodeName)return e+" - "+t.constructor.name+"\n";var n=t.nodeName.toLowerCase();return 0===n.indexOf("#")?e+"<"+n+">":e+"<"+n+' id="'+(t.id||"")+'">'}),"")+"_siblingIndex="+r)}(a)),r.default.track(n,t)}i.init=function(){o.default.addEvent(window,"oTracking.event",i)};var u=i;t.default=u},"6be2d8c7":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.session=c,t.init=d,t.default=void 0;var r,o=i(n("a09a7426")),a=i(n("10e45b30"));function i(e){return e&&e.__esModule?e:{default:e}}var u={storage:"best",name:"session",expires:18e5};function c(){var e,t=r.read(),n=!1;if(t){var a=(new Date).valueOf();parseInt(t.expiry,10)>=a&&(e=t.value)}return e||(e=o.default.guid(),n=!0),function(e){var t=new Date;t.setTime(t.getTime()+r.config.expires),r.write({value:e,expiry:t.valueOf()})}(e),{id:e,isNew:n}}function d(e){o.default.is(e,"string")&&(e={name:e}),o.default.isUndefined(e)&&(e={});var t=o.default.merge(u,e);return"cookie"===t.storage&&e.name&&(t.nameOverride=t.name),r=new a.default(t.name,t),c()}var s={init:d,session:c};t.default=s},"9caaec1a":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setRootID=s,t.getRootID=f,t.track=l,t.default=void 0;var r,o=d(n("f1b1acb7")),a=d(n("1cfe9588")),i=d(n("6be2d8c7")),u=d(n("4f317c41")),c=d(n("a09a7426"));function d(e){return e&&e.__esModule?e:{default:e}}function s(){return r=c.default.guid()}function f(){return r||s(),r}function l(e,t){c.default.isUndefined(t)&&(t=function(){});var n=i.default.session(),r={async:!0,callback:t||function(){},context:{id:e.id||c.default.guid(),root_id:f()},user:{passport_id:c.default.getValueFromCookie(/USERID=([0-9]+):/)||c.default.getValueFromCookie(/PID=([0-9]+)\_/),ft_session:c.default.getValueFromCookie(/FTSession=([^;]+)/),ft_session_s:c.default.getValueFromCookie(/FTSession_s=([^;]+)/)},device:{spoor_session:n.id,spoor_session_is_new:n.isNew,spoor_id:a.default.userID()}},d=u.default.get("config")||{};return d.context&&c.default.merge(r.context,d.context),d.user&&c.default.merge(r.user,d.user),d.device&&c.default.merge(r.device,d.device),c.default.merge(r,e),c.default.log("Core.Track",r),o.default.addAndRun(r),r}var g={setRootID:s,getRootID:f,track:l};t.default=g},a09a7426:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log=u,t.isUndefined=t.is=c,t.merge=d,t.encode=s,t.decode=f,t.addEvent=l,t.broadcast=g,t.onPage=v,t.triggerPage=p,t.getValueFromCookie=m,t.getValueFromUrl=h,t.getValueFromJsVariable=y,t.sanitise=w,t.assignIfUndefined=_,t.whitelistProps=b,Object.defineProperty(t,"guid",{enumerable:!0,get:function(){return o.default}}),t.default=void 0;var r=a(n("4f317c41")),o=a(n("be2f1d10"));function a(e){return e&&e.__esModule?e:{default:e}}var i=[];function u(){if(r.default.get("developer")&&window.console)for(var e=0;e<arguments.length;e++)window.console.log(arguments[e])}function c(e,t){return t||(t="undefined"),typeof e===t}function d(e,t){var n,r,o;for(n in t||(t=e,e={}),t)r=e[n],e!==(o=t[n])&&null!=o&&(e[n]=r!==Object(r)||c(r,"function")?o:d(r,o));return e}function s(e){return window.encodeURIComponent?window.encodeURIComponent(e):window.escape(e)}function f(e){return window.decodeURIComponent?window.decodeURIComponent(e):window.unescape(e)}function l(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function g(e,t,n){n=n||{};try{window.dispatchEvent(new CustomEvent(e+"."+t,{detail:n,bubbles:!0}))}catch(e){}}function v(e){c(e,"function")&&i.push(e)}function p(){for(var e=0;e<i.length;e++)i[e]()}function m(e){return document.cookie.match(e)&&""!==RegExp.$1&&"null"!==RegExp.$1?RegExp.$1:null}function h(e){return document.location.href.match(e)&&""!==RegExp.$1?RegExp.$1:null}function y(e){if("string"!=typeof e)return null;var t,n=e.split("."),r=window;for(t=0;t<n.length;t+=1){if(void 0===r[n[t]])return null;r=r[n[t]]}return""!==r?r:null}function b(e,t){return t.reduce((function(t,n){return Object.assign({},t,e[n]?(r={},o=n,a=e[n],o in r?Object.defineProperty(r,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[o]=a,r):void 0);var r,o,a}),{})}function w(e){return"string"==typeof e?e.trim():e}function _(e,t){for(var n in e)t[n]?console.warn("You can't set a custom property called ".concat(n)):t[n]=e[n]}var k={log:u,is:c,isUndefined:c,merge:d,encode:s,decode:f,guid:o.default,addEvent:l,broadcast:g,onPage:v,triggerPage:p,getValueFromCookie:m,getValueFromUrl:h,getValueFromJsVariable:y,sanitise:w,assignIfUndefined:_,whitelistProps:b};t.default=k},aaff5802:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.get=u,Object.defineProperty(t,"xhr",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"sendBeacon",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"image",{enumerable:!0,get:function(){return a.default}}),t.default=void 0;var r=i(n("00714c93")),o=i(n("f9f08965")),a=i(n("d7ae147b"));function i(e){return e&&e.__esModule?e:{default:e}}function u(e){return this.mock||this[e]}var c={xhr:r.default,sendBeacon:o.default,image:a.default,get:u};t.default=c},b4bf6f47:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.default=void 0;var r,o=s(n("1063c397")),a=s(n("1cc17586")),i=s(n("9caaec1a")),u=s(n("a09a7426")),c=s(n("4f317c41")),d=s(n("e3731389"));function s(e){return e&&e.__esModule?e:{default:e}}var f=["ctrlKey","altKey","shiftKey","metaKey"],l=function(e){return function(t,n){if("true"!==n.getAttribute("data-o-tracking-do-not-track")){var o,a=(o=t,f.reduce((function(e,t){try{o[t]&&(e[t]=u.default.sanitise(o[t]))}catch(e){console.log(e)}return e}),{})),s=(0,d.default)(n),l=s.trace,g=s.customContext;a.domPathTokens=l,a.url=window.document.location.href||null,u.default.assignIfUndefined(g,a),e.context=a,function(e){var t=e.context.domPathTokens[0],n=t.href||null,o=t["data-o-tracking-skip-queue"],a=o&&"true"===o.toLowerCase()||!1;n&&n.indexOf(window.document.location.hostname)>-1&&!a?(e.context.source_id=i.default.getRootID(),r.add(e).save()):(e.async=!1,i.default.track(e))}(u.default.merge(c.default.get("config"),e))}}},g=function e(t){var n=r.shift();n&&i.default.track(n,(function(t){e()}))},v=function(e,t){t=t||'a, button, input, [role="button"]';var n={action:"click",category:e||"o-tracking"};new o.default(document.body).on("click",t,l(n),!0),r=new a.default("clicks"),g(),u.default.onPage(g)};t.init=v;var p={init:v};t.default=p},be2f1d10:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.api=t.default=void 0;var r=0,o=Math.pow(36,4),a=function(e,t){var n="000000000"+e;return n.substr(n.length-t)},i=function(){return a((Math.random()*o<<0).toString(36),4)},u=function(){return r=r<o?r:0,++r-1},c=function(){var e=(new Date).getTime().toString(36),t=c.fingerprint(),n=i()+i();return"c"+e+a(u().toString(36),4)+t+n};t.api=c,c.slug=function(){var e,t=(new Date).getTime().toString(36),n=c.fingerprint().slice(0,1)+c.fingerprint().slice(-1),r=i().slice(-2);return e=u().toString(36).slice(-4),t.slice(-2)+e+n+r},c.globalCount=function(){var e=function(){var e=0;for(var t in window)e++;return e}();return c.globalCount=function(){return e},e},c.fingerprint=function(){return a((navigator.mimeTypes.length+navigator.userAgent.length).toString(36)+c.globalCount().toString(36),4)};var d=c;t.default=d},d7ae147b:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.image=a,t.default=void 0;var r,o=(r=n("a09a7426"))&&r.__esModule?r:{default:r};function a(){var e=new Image(1,1);return{name:"image",send:function(t,n){t=t.replace("https://spoor-api.ft.com/ingest","https://spoor-api.ft.com/px.gif"),e.src=t+(t.indexOf("?")>-1?"&":"?")+"data="+o.default.encode(n)},complete:function(t){e.addEventListener?(e.addEventListener("error",t),e.addEventListener("load",(function(){return t()}))):(e.attachEvent("onerror",t),e.attachEvent("onload",(function(){return t()})))}}}var i=a;t.default=i},e3731389:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n("a09a7426"))&&r.__esModule?r:{default:r};var a=["nodeName","className","id","href","text","role"],i=function(e,t,n){var r=Array.from(e.querySelectorAll(n)),o=r.findIndex((function(e){return e===t}));if(-1!==o)return{siblings:r.length,position:o}},u=function(e){return a.reduce((function(t,n){return e[n]?t[n]=o.default.sanitise(e[n]):e.getAttribute(n)?t[n]=o.default.sanitise(e.getAttribute(n)):e.hasAttribute(n)&&(t[n]=e.hasAttribute(n)),t}),{})},c=function(e,t){return e.filter((function(e){return e.name.match(/^data-trackable|^data-o-|^aria-/i)})).forEach((function(e){t[e.name]=e.value})),t},d=function(e,t,n){var r={};return n&&a.forEach((function(e){void 0!==t[e]&&"id"!==e&&(r[e]=t[e])})),e.filter((function(e){return e.name.match(/^data-trackable-context-/i)})).forEach((function(e){r[e.name.replace("data-trackable-context-","")]=e.value})),r};var s=function(e){for(var t=document,n=e,r=n.getAttribute("data-trackable")?'[data-trackable="'.concat(n.getAttribute("data-trackable"),'"]'):n.nodeName,a=[],s={};e&&e!==t;){var f=u(e),l=Array.from(e.attributes),g=c(l,f);g["data-trackable"]&&(g=Object.assign(g,i(e,n,r))),a.push(g);var v=d(l,f,e===n);o.default.assignIfUndefined(v,s),e=e.parentNode}return{trace:a,customContext:s}};t.default=s,e.exports=t.default},f1b1acb7:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=m,t.setDomain=p,t.getDomain=h,t.add=l,t.run=g,t.addAndRun=v,t.default=void 0;var r=u(n("4f317c41")),o=u(n("a09a7426")),a=u(n("1cc17586")),i=u(n("aaff5802"));function u(e){return e&&e.__esModule?e:{default:e}}var c,d="https://spoor-api.ft.com/px.gif";function s(){return navigator.sendBeacon&&Promise&&(r.default.get("config")||{}).useSendBeacon}function f(e,t){var n=e.queueTime,a=(new Date).getTime()-n,u=s()?i.default.get("sendBeacon")():window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest?i.default.get("xhr")():i.default.get("image")(),f=e.callback,l=r.default.get("config")&&r.default.get("config").system||{},g=o.default.merge(l,{api_key:r.default.get("api_key"),version:r.default.get("version"),source:r.default.get("source"),transport:u.name});e=o.default.merge({system:g},e),a>1e3&&a<31104e6&&(e.time=e.time||{},e.time.offset=a),delete e.callback,delete e.async,delete e.type,delete e.queueTime,o.default.log("user_callback",f),o.default.log("PreSend",e);var v=JSON.stringify(e);u.complete((function(r){if(o.default.is(f,"function")&&(f.call(e),o.default.log("calling user_callback")),r)if(Boolean(window.MSInputMethodContext)&&Boolean(document.documentMode)&&"xhr"===u.name){var a=i.default.get("image")();e.system.transport=[e.system.transport,a.name].join("-"),a.send(p,JSON.stringify(e)),a.complete((function(){t&&t()}))}else e.queueTime=n,c.add(e).save(),o.default.broadcast("oErrors","log",{error:r.message,info:{module:"o-tracking"}});else t&&t()}));var p=d;if(e&&e.category&&e.action){var m="type=".concat(e.category,":").concat(e.action);p=p.indexOf("?")>-1?"".concat(p,"&").concat(m):"".concat(p,"?").concat(m)}r.default.get("developer")&&r.default.get("no_send")||u.send(p,v)}function l(e){e.queueTime=(new Date).getTime(),s()?f(e):c.add(e).save(),o.default.log("AddedToQueue",c)}function g(e){o.default.isUndefined(e)&&(e=function(){});var t=c.all();if(t.length>200){var n={};t.forEach((function(e){var t=[e.category,e.action].join(":");n.hasOwnProperty(t)||(n[t]=0),n[t]+=1})),c.replace([]),c.add({category:"o-tracking",action:"queue-bug",context:{url:document.url,queue_length:t.length,counts:n,storage:c.storage.storage._type}})}var r=c.shift();return r?f(r,(function(){g(),e()})):e()}function v(e){l(e),g()}function p(){r.default.get("config")&&r.default.get("config").server&&(d=r.default.get("config").server)}function m(){return c=new a.default("requests"),p(),o.default.addEvent(window,"online",(function(){g()})),g(),c}function h(){return d}var y={init:m,setDomain:p,getDomain:h,add:l,run:g,addAndRun:v};t.default=y},f9f08965:function(e,t,n){"use strict";function r(){var e,t,n=new Promise((function(n,r){e=n,t=r}));return{name:"sendBeacon",send:function(n,r){navigator.sendBeacon(n,r)?e():t(new Error("Failed to send beacon event: "+r.toString()))},complete:function(e){e&&n.then(e,e)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.sendBeacon=r,t.default=void 0;var o=r;t.default=o}}]);
//# sourceMappingURL=financial-times-o-tracking.48d47e20d695.bundle.js.map