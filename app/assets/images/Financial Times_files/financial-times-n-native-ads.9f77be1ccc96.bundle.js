(window.webpackJsonp=window.webpackJsonp||[]).push([["financial-times-n-native-ads"],{"009fdb0c":function(e,t){e.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!t)throw new Error("No DFP response found");var n=0===e.length||e.includes(t.type);if(!n)throw new Error("DFP Response incorrect format");return t}},"486a2877":function(e,t){e.exports=function(e){if(!e||!e.title||!e.type)throw new Error("Native ad response incorrect format");switch(e.standfirst||(e.standfirst=e.summary,delete e.summary),"smartmatch"===e.type&&(e.type="promoted-content"),e.image&&!e.image.url&&delete e.image,e.type){case"special-report":return function(e){e.metaPrefixText="Special Report",!e.metaLink&&e.tag&&(e.metaLink={prefLabel:e.tag.name,relativeUrl:e.tag.url},delete e.tag);e.publishedDate||(e.publishedDate=e.lastPublished,delete e.lastPublished);e.firstPublishedDate||(e.firstPublishedDate=e.published,delete e.published);return e}(e);case"paid-post":return function(e){e.promotedPrefixText="Paid Post",e.advertiser&&!e.promotedSuffixText&&(e.promotedSuffixText="by ".concat(e.advertiser));return e}(e);case"promoted-content":return function(e){e.promotedPrefixText="Promoted Content",e.advertiser&&!e.promotedSuffixText&&(e.promotedSuffixText="by ".concat(e.advertiser));return e}(e);default:return e}}},"4bfc0256":function(e,t){e.exports=function(e){var t="object"==typeof e?e:new Function("return "+e)(),n=t?Object.keys(t):[],r=n.length?n[0]:null;if(!r)throw new Error("No ad unit key in dfp response");var o=t[r]._html_;if(!(o&&o.length&&o.indexOf("----------")>=0))throw new Error("No content from DFP response");try{var i=o.split("----------")[1],a=JSON.parse(i.replace(/\n/g,""));return a.id=t[r]._creative_ids_[0],a.lineItemId=t[r]._adgroup2_ids_[0],a}catch(e){throw new Error("Error trying to parse DFP JSON")}}},"6ddb6581":function(e,t){var n={partiallyViewed:null,fullyViewed:null};function r(e,t,r){var a=e.target,c=e.intersectionRatio;return e.isIntersecting?c<1?(clearTimeout(n.fullyViewed),void(n.partiallyViewed=setTimeout((function(){o(r)}),1e3))):void(n.fullyViewed=setTimeout((function(){t.unobserve(a),i(r)}),1e3)):(clearTimeout(n.partiallyViewed),void clearTimeout(n.fullyViewed))}var o=function(e){e("partial")},i=function(e){e("full")};e.exports={track:function(e,t){if(window.IntersectionObserver)if(e&&t){var n=new IntersectionObserver((function(e){e.forEach((function(e){return r(e,n,t)}))}),{threshold:[.5,1]});n.observe(e)}else console.warn("invalid parameters, track expects (nativeAdElement, callback)");else console.warn("Unable to track ad viewability, IntersectionObserver not available")},handleAdViewStatus:r}},"731807ae":function(e,t){e.exports=function(){return function(){for(var e="",t=0;t<48;t++){e+=(16*Math.random()|0).toString(16)}return e}()+"-"+(new Date).getTime()}},"83df5dd5":function(e,t){e.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=function(e){return parseInt(Math.random()*Math.pow(10,e),10)};return((new Date).getTime()+""+t(16)+Math.random().toString(34).slice(2)).toString().substr(0,e)}},"8f19bcc9":function(e,t,n){var r=n("f26e1e46");function o(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}var i=n("83df5dd5"),a=n("b8f58555");function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=i(),o="pos=native",a=e.targeting.get();t&&(a.ftpb=1),a.url=window&&window.location;var c=Object.keys(a).map((function(e){return e+"="+encodeURIComponent(a[e])})).join("&"),u=e.config("gpt").site?"".concat(e.config("gpt").network,"/").concat(e.config("gpt").site,"/").concat(e.config("gpt").zone):"5887/ft.com/home/UK",s="https://securepubads.g.doubleclick.net/gampad/ads?gdfp_req=1&correlator=".concat(r).concat(n,"&output=json_html&impl=fif&sc=1&sfv=1-0-4&iu=%2F5887%2F").concat(u.replace(/\/?5887\//,""),"&sz=320x50&fluid=height&scp=").concat(encodeURIComponent(o),"&d_imp=1&ga_sid=").concat((new Date).getTime(),"&cust_params=").concat(encodeURIComponent(c));return s}e.exports=function(){var e,t=(e=r.mark((function e(t,n){var o,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setUSPrivacy(),o=new Promise((function(e,t){var n=setTimeout(t,1e3);window.__uspapi("getUSPData",1,(function(t,r){var o=r?"&us_privacy=".concat(t.uspString):"";clearTimeout(n),e(o)}))})),e.prev=3,e.next=6,o;case 6:return i=e.sent,e.abrupt("return",c(t,n,i));case 10:return e.prev=10,e.t0=e.catch(3),e.abrupt("return",c(t,n));case 13:case"end":return e.stop()}}),e,null,[[3,10]])})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function c(e){o(a,r,i,c,u,"next",e)}function u(e){o(a,r,i,c,u,"throw",e)}c(void 0)}))});return function(e,n){return t.apply(this,arguments)}}()},"9428b4b9":function(e,t){e.exports=function(e,t,n,r){var o=encodeURIComponent(encodeURIComponent(n)),i=e.split("/"),a=i[i.length-1],c=t.smartmatchHost||"https://c.smartology.co";return"".concat(c,"/static/creative/").concat(t.creativeID,"/key/").concat(t.smartmatchKey,"/pcid/").concat(o,"/sct=").concat(encodeURIComponent(a),";encode=false;?cacheBuster=").concat(r)}},aa93916a:function(e,t){e.exports=function(e){return fetch(e,{timeout:4e3,mode:"cors"}).then((function(e){if(!e.ok)return{};var t=e.headers.get("content-type");return t&&t.includes("application/json")?e.json():e.text()})).catch((function(){return{}}))}},b4ec3b60:function(e,t){e.exports=function(e,t,n){if((n="string"==typeof n?n&&JSON.parse(n):n)&&n.type&&n.title)return n.impressionURL&&e.impressionURL&&(n.impressionURL=[].concat(n.impressionURL,e.impressionURL),n.impressionURL=n.impressionURL.map((function(e){return e.replace(/UNKNOWN_CACHE_BUSTER/g,t)}))),e.clickTrackingPrefix&&(n.url=e.clickTrackingPrefix+n.url.replace(/UNKNOWN_CACHE_BUSTER/g,t)),n;throw"No smartmatch results"}},eca70120:function(e,t,n){var r=n("ed007543"),o=n("6ddb6581").track;e.exports={get:r,track:o}},ed007543:function(e,t,n){var r=n("f26e1e46");function o(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}var i=n("8f19bcc9"),a=n("aa93916a"),c=n("4bfc0256"),u=n("009fdb0c"),s=n("f78ceac7"),f=n("486a2877"),p=function(){var e,t=(e=r.mark((function e(t,n){var o,p,l,d,m,v,h,w,g=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=g.length>2&&void 0!==g[2]?g[2]:[],p=g.length>3&&void 0!==g[3]&&g[3],l=t.config("gpt"),d=l.site,m=l.network,v=l.zone,h="5887/ft.com/home/UK",d&&(h="".concat(m,"/").concat(d,"/").concat(v)),e.next=7,i(t,p);case 7:return w=e.sent,e.abrupt("return",a(w).then(c).then(u.bind(null,o)).then(s.bind(null,h,n,t,o)).then(f).catch((function(e){return console.warn("n-native-ads: ".concat(e)),null})));case 9:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function c(e){o(a,r,i,c,u,"next",e)}function u(e){o(a,r,i,c,u,"throw",e)}c(void 0)}))});return function(e,n){return t.apply(this,arguments)}}();e.exports=p},f78ceac7:function(e,t,n){var r=n("731807ae"),o=n("9428b4b9"),i=n("aa93916a"),a=n("b4ec3b60");e.exports=function(e,t,c,u,s){if("smartmatch"!==s.type)return Promise.resolve(s);var f=r(),p=n("ed007543"),l=o(e,s,t,f);return i(l).then(a.bind(null,s,f)).catch((function(){return p(c,t,u,!0)}))}}}]);
//# sourceMappingURL=financial-times-n-native-ads.9f77be1ccc96.bundle.js.map